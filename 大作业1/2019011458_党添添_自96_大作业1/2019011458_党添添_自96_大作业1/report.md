## 数值分析第一次大作业报告

学号：2019011458   姓名：党添添   班级:自96

##### 第一题

（1)思路分析

我的方法比较简单。首先，把最后要得到的图像的点的坐标转化为极坐标，然后找到这个极坐标对应的给的图形的直角坐标，然后根据已知点进行插值，计算出最后要得到的图像的某个点的值。

（2）数学推导和误差分析

对于最后得到的方形二维码，设某个点的坐标为(des_x,des_y)。

**注意，这里的坐标与常识有所不同，读进来的数据是二维数组，第0维是x，代表纵向；第1维是y，代表横向。**

根据读进来的极坐标二维码可以得知其边长为2013。

对应的得到的方形二维码的边长应为1006.5（$\frac{2013}{2} = 1006.5$）

所以(des_x,des_y)对应的极坐标应为：

$\theta = \frac{x}{1006.5} \times 2\pi$

$r = y$

这个极坐标对应到极坐标二维码读出的数据上来说：

$ori\_y = 1006.5+r\cdot cos(\theta)$

$ori\_x = 1006.5-r\cdot cos(\theta)$

然后根据极坐标二维码给出的整数点进行双线性插值

设$x\in(u,u+1),y\in(v,v+1),u,v都是整数$

先**固定y**，对x进行插值：

$g(x,v) = (x-u)*g(u+1,v) - g(u,v)*(x-u-1)$

$g(x,v+1) = (x-u)*g(u+1,v+1) - g(u,v+1)*(x-u-1)$

误差:$R(x,v) = k_{1}(x)(x-u)(x-u-1)$

再对y插值：

$g(x,y)  = (v+1-y)*g(x,v)+(y-v)*g(x,v+1)$

对y插值本身的误差:$R(y) = k_{2}(y-v)(y-v-1)$

由于迭代计算造成的误差：$R_{1}(x,y) = (v+1-y)R(x,v) +(y - v)R(x,v+1)$

总的截断误差:$R(x,y) = R_{1}(x,y)+R_{y} =(v+1-y)R(x,v) +(y - v)R(x,v+1)+k_{2}(y)(y-v)(y-v-1)$

$|R(x,v)| = |k_{1}(x)(x-u)(x-u-1)|\leq M \times \frac{1}{4}\times\frac{1}{2}$

$R(y) = k_{2}(y-v)(y-v-1)\leq M\times\frac{1}{4}\times \frac{1}{2}$

$max|R(x,y)|\le |v+1-y|\cdot|R(x,v)|+|y-v|\cdot|R(x,v+1)|+|k_2(y)||(y-v)(y-v-1)|\leq \frac{1}{4}M$



(3)所得二维码

<img src="C:\Users\hutter_sadan\AppData\Roaming\Typora\typora-user-images\image-20211023210032540.png" alt="image-20211023210032540" style="zoom:33%;" />



#### 第二题

（1）

令已知采样点的坐标为$x_{0},....x_{100}$,$y_{0},....y_{100}$,$z_{0},....z_{100}$。$x_{0} = y_{0} = z_{0} = -3$。

与第一题类似，先固定y和z，对x插值。

$h_{n,n}(x) = f(x,y_{n},z_{n}) = \frac{x-x_{n}}{x_{n+1}-x_{n}}(f(x_{n+1},y_{n},z_{n})-f(x_{n},y_{n},z_{n}))+f(x_{n},y_{n},z_{n})$

同理，可得$h_{n,n+1}(x),h_{n+1,n}(x),h_{n+1,n+1}(x)$

对于$h_{n,n}(x)$来说，误差：$R_{x}(x)=k_{1}(x)(x-x_{n})(x-x_{n+1})$

再对y插值：

令$g_{n}(x,y_{n+1}) = f(x,y_{n+1},z_{n})= h_{n+1,n}(x)$,$g_{n}(x,y_{n}) = f(x,y_{n},z_{n}) = h_{n,n}(x)$

$g_{n}(x,y) = f(x,y,z_{n}) = \frac{y-y_{n}}{y_{n+1}-y_{n}}(g_{n}(x,y_{n+1})-g_{n}(x,y_{n}))+g_{n}(x,y_{n})$

同理，可得$g_{n+1}(x,y)$

对于$g_{n}(x,y)$来说，误差：$R_{x,y}(x,y)=\frac{y-y_{n}}{y_{n+1}-y_{n}}(R_{x}(x) - R_{x}(x))+R_{x}(x)+k_{2}(y)(y-y_{n})(y-y_{n+1})=R_{x}(x)+k_{2}(y)(y-y_{n})(y-y_{n+1})$

再对z插值：

令$w(z_{n+1}) = f(x,y,z_{n})= g_{n+1}(x,y)$,$w(z_{n}) = f(x,y,z_{n}) = g_{n}(x,y)$

$w(x,y,z) = f(x,y,z) = \frac{z-z_{n}}{z_{n+1}-z_{n}}(w(z_{n+1})-w(z_{n}))+w(z_{n})$

$w(x,y,z)$就是所得点（x，y，z）的SDF

误差：$R_{x,y,z} = R_{x,y}(x,y)+k_{3}(z-z_{n})(z-z_{n+1})$

$max|R_{x,y,z}| = \frac{1}{8}M\times3 = \frac{3}{8}M$





(2)

我选择使用第一种方法求表面点，即利用插值得到分辨率更高的 SDF，取绝对值小于某一阈值的点作为表面点 。

我先用random.uniform生成了生成了600,0000个点，然后算这600,0000个点的SDF，选择小于阈值的点作为表面点。

我选择的阈值是0.01（实际上，0.05左右都能取得较好的图像）。可以得到的可视化表面点的图如下：（附件：表面点文件夹里面的heart.obj和heart.ply）

<img src="C:\Users\hutter_sadan\AppData\Roaming\Typora\typora-user-images\image-20211023212944698.png" alt="image-20211023212944698" style="zoom: 23%;" />



（3）

按照油管上的视频所说，逐步操作，可得图像为下图（我保存到了3Dmash文件夹里面的3Dmash.ply和3Dmash.obj）：

<img src="C:\Users\hutter_sadan\AppData\Roaming\Typora\typora-user-images\image-20211023213615006.png" alt="image-20211023213615006" style="zoom:25%;" />



#### 第三题

第三题就是一个简单的最小二乘法：

先对方程进行一个简单的变换:

$(2x^{2}+y^{2}+z^{2}-1)^{3}+ax^{2}z^{3}+by^{2}z^{3}=0$

$\frac{(2x^{2}+y^{2}+z^{2}-1)^{3}}{b}+\frac{a}{b}x^{2}z^{3}=-y^{2}z^{3}$

令$Y=-y^{2}z^{3}$,$X=x^{2}z^{3}$,$a_{1} = \frac{a}{b}$,$b_{1}=\frac{(2x^{2}+y^{2}+z^{2}-1)^{3}}{b}$

$Y=a_1X+b_1$

写成向量形式（$\vec X$,$\vec Y$都是列向量）:

$\vec Y = a_1\vec X+b_1\cdot \vec 1$

同时左乘$\vec X^{T}$,即求取内积:

$\vec X^{T} \vec Y = a_1\vec X^{T}\vec X+b_1\cdot \vec X^{T}\vec 1$

可得：

$a_{1}^{ols} = (\vec X^{T}\vec X)^{-1}\vec X^{T} \vec Y = -1.37$

$b_1^{ols} = \bar Y - \bar X \times a_1 = -0.06$

代回原式：

$a^{ols} = 2.43$,$b^{ols} = -1.78$



### 附件相关：

上述提到的附件都已经放入对应的文件夹中了。代码有1.py，2.py和3.py。分别对应第一题，第二题和第三题的代码。

### 总结：

这次大作业比较简单，但也很有意义。我进一步认识到了插值的作用。如果没有计算机的话，手算插值表达式往往比较繁琐。但是在计算机的帮助下，计算插值表达式和得出结果就方便了很多，思路也更加清晰。唯有误差分析比较繁琐，需要考虑很多。总体而言，这是一次虽然轻松，但也充满意义的大作业。